<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="fragments/header :: header"/>
    <th:block th:replace="fragments/mainHeader :: mainHeader"/>

    <style>
        #bodyTop .carousel-inner .carousel-item img{
            /*width: 0 auto;*/
            height: 400px;
        }
        #cafeTop5Container{
            display: flex;
        }

        #cafeTop5Container .card div figure .card-img-top{
            height: 100px;
        }
    </style>
    <script>
        $(document).ready(function(){
            getCafeTop5();
        });

        function getCafeTop5() {
            $('#cafeTop5Container').empty();
            $.ajax({
                type: "GET",
                url: "/api/cafes/top5",
                data: {},
                success: function(response){
                    let cafeList = response;
                    let id, cafeName, cafeInfo, cafeWeekdayPrice, cafeImageUrlList, tempHtml;

                    for (const cafeListElement of cafeList) {
                        console.log(cafeListElement)
                        id = cafeListElement["id"];
                        cafeName = cafeListElement["cafeName"];
                        cafeInfo = cafeListElement["cafeInfo"];
                        cafeWeekdayPrice = cafeListElement["cafeWeekdayPrice"];
                        cafeImageUrlList = cafeListElement["cafeImgUrls"];

                        tempHtml = makeHtml(id, cafeName, cafeInfo, cafeWeekdayPrice, cafeImageUrlList);
                        $("#cafeTop5Container").append(tempHtml);
                    }

                    console.log(cafeName, cafeInfo, cafeWeekdayPrice, cafeImageUrlList);
                    // alert(cafeList)

                }
            })
        }

        function makeHtml(id, cafeName, cafeInfo, cafeWeekdayPrice, cafeImageUrlList){
            return `<div class="card" onclick="#" style="width: 200px; height: 250px;">
                        <div class="card-image">
                            <figure class="image is-4by3">
                                <img src="${cafeImageUrlList[0]}" class="card-img-top" alt="Placeholder image">
                            </figure>
                        </div>
                        <div class="card-content">
                            <div class="media">
                                <div class="media-content">
                                    <p id="title" class="title is-4">${cafeName}</p>
                                    <p class="subtitle is-6">${cafeInfo}</p>
                                    <p>₩${cafeWeekdayPrice.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')}</p>
                                </div>
                            </div>
                        </div>
                   </div>`;
        }
    </script>
</head>
<body>
<div th:replace="fragments/mainTop :: mainTop"/>
<!-- 메인페이지 광고 배너 -->
<div id="bodyTop">
    <!-- Carousel -->
    <div id="demo" class="carousel slide" data-bs-ride="carousel">

        <!-- Indicators/dots -->
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#demo" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="2"></button>
        </div>

        <!-- The slideshow/carousel -->
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://eventcafecloud-bucket.s3.ap-northeast-2.amazonaws.com/cafeImage/019eb986-8c13-4d59-905e-c0cf966985ee.png" alt="Los Angeles" class="d-block" style="width:100%">
                <div class="carousel-caption">
                    <h3>Los Angeles</h3>
                    <p>We had such a great time in LA!</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://eventcafecloud-bucket.s3.ap-northeast-2.amazonaws.com/cafeImage/014a20e4-5fc5-4b7c-9a75-c0140ca1176b.PNG" alt="Chicago" class="d-block" style="width:100%">
                <div class="carousel-caption">
                    <h3>Chicago</h3>
                    <p>Thank you, Chicago!</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://eventcafecloud-bucket.s3.ap-northeast-2.amazonaws.com/userProfileImage/9f73b43a-212f-4cfc-a762-a270ccee1e7e.jpeg" alt="New York" class="d-block" style="width:100%">
                <div class="carousel-caption">
                    <h3>New York</h3>
                    <p>We love the Big Apple!</p>
                </div>
            </div>
        </div>

        <!-- Left and right controls/icons -->
        <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>
</div>
<div id="bodyMiddle">
    <div id="cafeTop5">
        <h6>Cafe Top 5</h6>
        <div id="cafeMore">
            <button onclick="location.href='/cafes/all'">더보기</button>
        </div>
        <div id="cafeTop5Container"></div>
    </div>
</div>
</body>
</html>